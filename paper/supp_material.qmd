---
title: "Supplemental material"
format:
  pdf:
    documentclass: article
    number-sections: true
    pdf-engine: pdflatex
    toc: false
    include-in-header: [preamble.tex]
    #include-before-body: template/preambule.tex
    geometry:
      - top=2cm
      - bottom=2cm
      - left = 2.5cm
      - right = 2.5cm
linestretch: 2
echo: false
tbl-cap-location: top
fig-cap-location: top
---

\appendix

# Coefficients, gain and phase shift functions {#sec-an-cof}

```{r, out.width="100%"}
#| label: fig-graphs-coef-lc
#| fig-cap: Coefficients, gain and phase shift functions for the Linear-Constant (LC) filter with $I/C=3.5$.
img <- sprintf("img/filters_used/%s.%s", tolower("LC"), "pdf")
knitr::include_graphics(img)
```

```{r, out.width="100%"}
#| label: fig-graphs-coef-ql
#| fig-cap: Coefficients, gain and phase shift functions for the Quadratic-Linear (QL) filter with $I/C=3.5$.
img <- sprintf("img/filters_used/%s.%s", tolower("QL"), "pdf")
knitr::include_graphics(img)
```


```{r, out.width="100%"}
#| label: fig-graphs-coef-cq
#| fig-cap: Coefficients, gain and phase shift functions for the Cubic-Quadratic (CQ) filter with $I/C=3.5$.
img <- sprintf("img/filters_used/%s.%s", tolower("CQ"), "pdf")
knitr::include_graphics(img)
```

```{r, out.width="100%"}
#| label: fig-graphs-coef-daf
#| fig-cap: Coefficients, gain and phase shift functions for the direct asymmetric filter (DAF).
img <- sprintf("img/filters_used/%s.%s", tolower("DAF"), "pdf")
knitr::include_graphics(img)
```

\newpage

# Impact of the span used to detect the ARIMA model

::: {#fig-graphs-impact-span}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_arima_length.pdf")
```

Distribution of phase shifts on simulated series by number of years used to identify and estimate the AIRMA model.
:::

\newpage

#

::: {#fig-graphs-impact-span}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_local_final_lc.pdf")
```

Distribution of phase shifts associated to the local parametrisation of the linear-constant (LC) filter using the final estimates of $\delta/\sigma$ in function of the length of the henderson filter used to estimate $\sigma$ ($h$) and the degree of the trend to estimate $\delta$ ($d$)/
:::

::: {#fig-graphs-impact-span}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_local_lc.pdf")
```

Distribution of phase shifts associated to the local parametrisation of the linear-constant (LC) filter using real time estimates of $\delta/\sigma$ in function of the length of the henderson filter used to estimate $\sigma$ ($h$) and the degree of the trend to estimate $\delta$ ($d$)/
:::

::: {#fig-graphs-impact-span}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_local_ql.pdf")
```

Distribution of phase shifts associated to the local parametrisation of the quadratic-linear (QL) filter using real time estimates of $\delta/\sigma$ in function of the length of the henderson filter used to estimate $\sigma$ ($h$) and the degree of the trend to estimate $\delta$ ($d$)/
:::

\newpage

# Quarterly data

::: {#fig-graphs-impact-span}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_q.pdf")
```

Distribution of phase shifts on quarterly data.
:::


\newpage
# Nearest neighbour bandwidth


```{r, out.width="100%"}
#| label: fig-graphs-coef-lc-nn
#| fig-cap: Coefficients, gain and phase shift functions for the Linear-Constant (LC) filter with $I/C=3.5$ and a nearest neighbour bandwidth.
img <- sprintf("img/filters_used/%s_nn.%s", tolower("LC"), "pdf")
knitr::include_graphics(img)
```

```{r, out.width="100%"}
#| label: fig-graphs-coef-ql-nn
#| fig-cap: Coefficients, gain and phase shift functions for the Quadratic-Linear (QL) filter with $I/C=3.5$ and a nearest neighbour bandwidth.
img <- sprintf("img/filters_used/%s_nn.%s", tolower("QL"), "pdf")
knitr::include_graphics(img)
```


```{r, out.width="100%"}
#| label: fig-graphs-coef-cq-nn
#| fig-cap: Coefficients, gain and phase shift functions for the Cubic-Quadratic (CQ) filter with $I/C=3.5$ and a nearest neighbour bandwidth.
img <- sprintf("img/filters_used/%s_nn.%s", tolower("CQ"), "pdf")
knitr::include_graphics(img)
```

```{r, out.width="100%"}
#| label: fig-graphs-coef-daf-nn
#| fig-cap: Coefficients, gain and phase shift functions for the direct asymmetric filter (DAF) with a nearest neighbour bandwidth.
img <- sprintf("img/filters_used/%s_nn.%s", tolower("DAF"), "pdf")
knitr::include_graphics(img)
```


::: {#fig-nn-lp}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_nn_lp.pdf")
```

Distribution of phase shifts using nearest neighbour bandwidth.
:::

::: {#fig-nn-localparam}
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("img/simulations/phase_shift_simul_nn_localparam.pdf")
```
Note: nearest bandwidth moving average are used to estimate slope and concavity.
We thus do not distinguish local parametrisation and final local parametrisation which asumptions might not be plausible.
Indeed, using the same framework as for fixed bandwidth, the final local parametrisation for real time estimates would implie modelling a polynomial of degree 2 or 3 other 25 months (which doesn't seem plausible).

Distribution of phase shifts using nearest neighbour bandwidth for polynomial filters with local parametrisation.
:::

<!-- # R code example {#ann-ex-r} -->

<!-- In this appendix we present the {{< fa brands r-project >}} code that can be used to estimate trend-cycle components for the US Employment with local polynomial filters. -->

<!-- ```{r, eval=FALSE, echo=TRUE} -->
<!-- #| eval: false -->
<!-- #| echo: true -->
<!-- #| file: R_ex.R -->
<!-- ``` -->
